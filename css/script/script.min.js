var date=new Date,today=new Date,texts={months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],months1:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],days:["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ","ВС"]};function monthAndYear(date){var showDate;document.querySelector("#show_date").innerHTML=texts.months[date.getMonth()]+" "+date.getFullYear(),createUl(date)}function activateButtons(date){var back=document.querySelector("#back"),forward;document.querySelector("#forward").addEventListener("click",(function(){date.setMonth(date.getMonth()+1),monthAndYear(date)})),back.addEventListener("click",(function(){date.setMonth(date.getMonth()-1),monthAndYear(date)}))}function greenDay(elem,num,date){num===today.getDate()&&today.getDate()===date.getDate()&&date.getMonth()===today.getMonth()&&date.getFullYear()===today.getFullYear()&&(elem.style.backgroundColor="green",elem.style.color="white")}function redDay(elem,num,date){var dateBeta=new Date;dateBeta.setMonth(date.getMonth()),dateBeta.setFullYear(date.getFullYear()),dateBeta.setDate(num);var day=dateBeta.getDay();0!==day&&6!==day||(elem.style.color="red",elem.style.borderColor="red")}function dayFix(date,num){var dateBeta=new Date;return dateBeta.setMonth(date.getMonth()),dateBeta.setFullYear(date.getFullYear()),dateBeta.setDate(num),dateBeta.getDate()}function createUl(date){var Old=document.querySelector("#thisMonth");document.querySelector("#calendarContainer").removeChild(Old);var thisMonth=document.createElement("div");thisMonth.id="thisMonth";for(var before=getFirstDayInMonth(date),after=getLastDayInMonth(date),to=currentMonthLastDay(date)+after,i=1-before;i<=to;i++){var dayCell=document.createElement("div");dayCell.className="day_cell",addUniqueIdCell(date,i,dayCell),activateChecklistToDayCell(dayCell);var exactDate=dayFix(date,i);dayCell.innerHTML=exactDate+"<br/>"+texts.days[getDayInMonth(date,i)],redDay(dayCell,i,date),greenDay(dayCell,i,date),thisMonth.appendChild(dayCell),divideWeeks(date,i,dayCell)}document.querySelector("#calendarContainer").appendChild(thisMonth)}function addUniqueIdCell(date,num,elem){var dateBeta=new Date;dateBeta.setMonth(date.getMonth()),dateBeta.setFullYear(date.getFullYear()),dateBeta.setDate(num),elem.id="dc_"}function divideWeeks(date,exactDate,elem){getDayInMonth(date,exactDate)%7==0&&elem.insertAdjacentHTML("afterEnd","<br/>")}function currentMonthLastDay(date){var month=date.getMonth(),year=date.getFullYear();return 0===month||2===month||4===month||6===month||7===month||9===month||11===month?31:3===month||5===month||8===month||10===month?30:1===month&&year%4==0?29:28}function getDayInMonth(date,num){var dateBeta=new Date;dateBeta.setMonth(date.getMonth()),dateBeta.setFullYear(date.getFullYear()),dateBeta.setDate(num);var day=dateBeta.getDay();return day=fixSunday(day)}function getFirstDayInMonth(date){return getDayInMonth(date,1)-1}function getLastDayInMonth(date){return 7-getDayInMonth(date,currentMonthLastDay(date))}function fixSunday(day){return 0===day?7:day}function activateChecklistToDayCell(elem){elem.addEventListener("click",(function(){var checklist;document.getElementById("ul"+elem.id)?showChecklistToDayCell(elem):checklistStartUnique(elem)}))}function showChecklistToDayCell(elem){hideAllChecklist(),document.getElementById("ul"+elem.id.slice(2)).style.display="block"}function hideAllChecklist(){for(var checklistUls=document.querySelectorAll(".checklistUl"),i=0;i<checklistUls.length;i++)checklistUls[i].style.display="none"}function addDayName(parent){var string=document.createElement("h3"),year=parent.id.slice(3,7),month=texts.months1[Number(parent.id.slice(8,11))-100],day=Number(parent.id.slice(12))-100;string.innerHTML=day+" "+month+" "+year+" года.",parent.appendChild(string)}function checklistStartUnique(elem){hideAllChecklist();var checklistContainer=document.querySelector("#checklistContainer"),checklistUl=document.createElement("ul");checklistUl.id="ul"+elem.id.slice(2),checklistUl.className="checklistUl",checklistUl.style.display="block";var checklistCreate=document.createElement("input");checklistCreate.type=" text",checklistCreate.addEventListener("keyup",(function(event){13==event.keyCode&&addLi(checklistCreate,checklistUl)})),addDayName(checklistUl),checklistUl.appendChild(checklistCreate),checklistContainer.appendChild(checklistUl)}function addLi(input,ul){var li=document.createElement("li");li.innerHTML="<span>"+input.value+"</span>",input.value="",ul.appendChild(li),addClose(li),addCheckbox(li),addRedact(li)}function addClose(parent){var close=document.createElement("button");close.innerHTML="X",close.className="closeButton",close.addEventListener("click",(function(){this.parentNode.parentNode.removeChild(this.parentNode)})),parent.appendChild(close)}function addCheckbox(parent){var checkbox=document.createElement("input");checkbox.type="checkbox",checkbox.addEventListener("click",(function(){this.parentNode.className="done",this.parentNode.removeChild(this)})),parent.insertBefore(checkbox,parent.firstChild)}function addRedact(elem){var span;elem.querySelector("span").addEventListener("dblclick",(function(){if(!this.parentNode.classList.contains("done")){var input=document.createElement("input");input.value=this.innerHTML,this.innerHTML="",input.addEventListener("keyup",(function(event){13==event.keyCode&&(input.parentNode.innerHTML=input.value)})),this.appendChild(input),input.focus()}}))}monthAndYear(date),activateButtons(date);